{"version":3,"file":"index.module.js","sources":["../src/fetch.ts","../src/twitter/api.ts","../src/twitter/embed/tweet-html.ts","../src/twitter/tweet-html.ts","../src/markdown/markdownToAst.ts","../src/twitter/getTweetHtml.ts","../node_modules/unist-util-is/index.js","../node_modules/unist-util-visit-parents/color.js","../node_modules/unist-util-visit-parents/index.js","../node_modules/unist-util-visit/index.js","../../../node_modules/mdast-util-to-string/index.js","../src/markdown/rehype-tweet.ts","../src/markdown/rehype-minify.ts","../../../node_modules/hast-util-sanitize/lib/schema.js","../src/markdown/schema.ts","../src/markdown/htmlToAst.ts","../src/fetchTweetAst.ts"],"sourcesContent":["import vercelFetch from '@vercel/fetch'\n\nexport default vercelFetch()\n","import fetch from '../fetch'\n\nconst API_URL = 'https://api.twitter.com'\nconst SYNDICATION_URL = 'https://syndication.twitter.com'\n\nfunction twitterLabsEnabled(expansions) {\n  if (process.env.TWITTER_LABS_ENABLED !== 'true') return false\n  if (!expansions) return true\n\n  const exp = process.env.TWITTER_LABS_EXPANSIONS || ''\n\n  return exp.includes(expansions)\n}\n\nexport async function fetchTweetsHtml(ids) {\n  const res = await fetch(`${SYNDICATION_URL}/tweets.json?ids=${ids}`)\n\n  if (res.ok) return res.json()\n  if (res.status === 404) return {}\n\n  throw new Error(\n    `Fetch for the embedded tweets of \"${ids}\" failed with code: ${res.status}`\n  )\n}\n\nexport async function fetchTweetHtml(id) {\n  const html = await fetchTweetsHtml(id)\n  return html[id]\n}\n\nexport async function fetchUserStatus(tweetId) {\n  // If there isn't an API token don't do anything, this is only required for videos.\n  if (!process.env.TWITTER_ACCESS_TOKEN) return\n\n  const res = await fetch(\n    `${API_URL}/1.1/statuses/show/${tweetId}.json?include_entities=true&tweet_mode=extended`,\n    {\n      headers: {\n        authorization: `Bearer ${process.env.TWITTER_ACCESS_TOKEN}`\n      }\n    }\n  )\n\n  console.log(\n    'Twitter x-rate-limit-limit:',\n    res.headers.get('x-rate-limit-limit')\n  )\n  console.log(\n    'Twitter x-rate-limit-remaining:',\n    res.headers.get('x-rate-limit-remaining')\n  )\n  console.log(\n    'Twitter x-rate-limit-reset:',\n    res.headers.get('x-rate-limit-reset')\n  )\n\n  if (res.ok) return res.json()\n  if (res.status === 404) return\n\n  throw new Error(`Fetch to the Twitter API failed with code: ${res.status}`)\n}\n\nexport async function fetchTweetWithPoll(tweetId) {\n  const expansions = 'attachments.poll_ids'\n\n  // If there isn't an API token or Twitter Labs is not enabled, don't do anything,\n  // this is only required for Polls.\n  if (!process.env.TWITTER_ACCESS_TOKEN || !twitterLabsEnabled(expansions))\n    return\n\n  const res = await fetch(\n    `${API_URL}/labs/1/tweets?format=compact&expansions=${expansions}&ids=${tweetId}`,\n    {\n      headers: {\n        authorization: `Bearer ${process.env.TWITTER_ACCESS_TOKEN}`\n      }\n    }\n  )\n\n  console.log(\n    'Twitter Labs x-rate-limit-limit:',\n    res.headers.get('x-rate-limit-limit')\n  )\n  console.log(\n    'Twitter Labs x-rate-limit-remaining:',\n    res.headers.get('x-rate-limit-remaining')\n  )\n  console.log(\n    'Twitter Labs x-rate-limit-reset:',\n    res.headers.get('x-rate-limit-reset')\n  )\n\n  if (res.ok) return res.json()\n  if (res.status === 404) return\n\n  throw new Error(\n    `Fetch to the Twitter Labs API failed with code: ${res.status}`\n  )\n}\n\nexport async function getEmbeddedTweetHtml(url) {\n  const res = await fetch(`https://publish.twitter.com/oembed?url=${url}`)\n\n  if (res.ok) return res.json()\n  if (res.status === 404) return\n\n  throw new Error(`Fetch for embedded tweet failed with code: ${res.status}`)\n}\n","import cheerio from 'cheerio'\n\nfunction getTweetContent($) {\n  const container = $('.EmbeddedTweet-tweetContainer')\n\n  if (!container.length) return\n\n  const meta: any = {}\n  const content: any = { meta }\n\n  // This is the blockquote with the tweet\n  const subject = container.find('[data-scribe=\"section:subject\"]')\n\n  // Tweet header with the author info\n  const header = subject.children('.Tweet-header')\n  const avatar = header.find('[data-scribe=\"element:avatar\"]')\n  const author = header.find('[data-scribe=\"component:author\"]')\n  const name = author.find('[data-scribe=\"element:name\"]')\n  const screenName = author.find('[data-scribe=\"element:screen_name\"]')\n\n  // Tweet body\n  const tweet = subject.children('[data-scribe=\"component:tweet\"]')\n  const tweetContent = tweet.children('p')\n  const card = tweet.children('.Tweet-card')\n  const tweetInfo = tweet.children('.TweetInfo')\n  const fullTimestamp = tweetInfo.find('[data-scribe=\"element:full_timestamp\"]')\n  const heartCount = tweetInfo.find('[data-scribe=\"element:heart_count\"]')\n\n  // Tweet footer\n  const callToAction = container.children(\n    '[data-scribe=\"section:cta component:news\"]'\n  )\n  const profileText = callToAction.children(\n    '[data-scribe=\"element:profile_text\"]'\n  )\n  const conversationText = callToAction.children(\n    '[data-scribe=\"element:conversation_text\"]'\n  )\n\n  let quotedTweet\n  let mediaHtml\n\n  meta.id = subject.attr('data-tweet-id')\n  meta.avatar = {\n    normal: avatar.attr('data-src-1x')\n  }\n  meta.name = name.text()\n  meta.username = screenName.text().substring(1) // Omit the initial @\n  meta.createdAt = new Date(fullTimestamp.attr('data-datetime')).getTime()\n  meta.heartCount = heartCount.text()\n  meta.ctaType = profileText.length ? 'profile' : 'conversation'\n\n  if (conversationText.length) {\n    // Get the formatted count and skip the rest\n    meta.ctaCount = conversationText.text().match(/^[^\\s]+/)[0]\n  }\n\n  // If some text ends without a trailing space, it's missing a <br>\n  tweetContent.contents().each(function () {\n    const el = $(this)\n    const type = el[0].type\n\n    if (type !== 'text') return\n\n    const text = el.text()\n\n    if (text.length && text.trim() === '') {\n      if (el.next().children().length) {\n        el.after($('<br>'))\n      }\n    } else if (\n      !/\\s$/.test(el.text()) &&\n      el.next().children().length &&\n      !/^[#@]/.test(el.next().text())\n    ) {\n      el.after($('<br>'))\n    }\n  })\n\n  card.children().each(function () {\n    const props = this.attribs\n    const scribe = props['data-scribe']\n    const el = $(this)\n\n    if (scribe === 'section:quote') {\n      const tweetCard = el.children('a')\n      const id = tweetCard.attr('data-tweet-id')\n      const url = tweetCard.attr('href')\n\n      quotedTweet = { id, url }\n      return\n    }\n\n    const media = $('<div>')\n\n    if (scribe === 'component:card') {\n      const photo = el.children('[data-scribe=\"element:photo\"]')\n      const photoGrid = el.children('[data-scribe=\"element:photo_grid\"]')\n      const photos = photo.length ? photo : photoGrid\n\n      if (photos.length) {\n        const images = photos.find('img')\n\n        images.each(function () {\n          const img = $(this)\n          const alt = img.attr('alt')\n          const url = img.attr('data-image')\n          const format = img.attr('data-image-format')\n          const height = img.attr('height')\n          const width = img.attr('width')\n\n          this.attribs = {\n            'data-type': 'media-image',\n            src: `${url}?format=${format}`,\n            height,\n            width\n          }\n          if (alt) {\n            this.attribs.alt = alt\n          }\n          // Move the media img to a new container\n          media.append(img)\n        })\n        media.attr('data-type', `image-container ${images.length}`)\n        mediaHtml = $('<div>').append(media).html()\n      }\n    }\n  })\n\n  tweetContent.children('img').each(function () {\n    const props = this.attribs\n\n    // Handle emojis inside the text\n    if (props.class?.includes('Emoji--forText')) {\n      this.attribs = {\n        'data-type': 'emoji-for-text',\n        src: props.src,\n        alt: props.alt\n      }\n      return\n    }\n\n    console.error(\n      'An image with the following props is not being handled:',\n      props\n    )\n  })\n\n  tweetContent.children('a').each(function () {\n    const props = this.attribs\n    const scribe = props['data-scribe']\n    const el = $(this)\n    const asTwitterLink = (type) => {\n      this.attribs = {\n        'data-type': type,\n        href: props.href\n      }\n      // Replace custom tags inside the anchor with text\n      el.text(el.text())\n    }\n\n    // @mention\n    if (scribe === 'element:mention') {\n      return asTwitterLink('mention')\n    }\n\n    // #hashtag\n    if (scribe === 'element:hashtag') {\n      // A hashtag may be a $cashtag too\n      const type =\n        props['data-query-source'] === 'cashtag_click' ? 'cashtag' : 'hashtag'\n      return asTwitterLink(type)\n    }\n\n    if (scribe === 'element:url') {\n      const url = props['data-expanded-url']\n      // const quotedTweetId = props['data-tweet-id']\n\n      // Remove link to quoted tweet to leave the card only\n      // if (quotedTweetId && quotedTweetId === quotedTweet?.id) {\n      //   el.remove();\n      //   return;\n      // }\n\n      // Handle normal links\n      const text = { type: 'text', data: url }\n      // Replace the link with plain text and markdown will take care of it\n      el.replaceWith(text)\n    }\n  })\n\n  content.html = tweetContent.html()\n\n  if (quotedTweet) content.quotedTweet = quotedTweet\n  if (mediaHtml) content.mediaHtml = mediaHtml\n\n  return content\n}\n\nexport function getTweetData(html) {\n  const $ = cheerio.load(html, {\n    decodeEntities: false,\n    xmlMode: false\n  })\n  const tweetContent = getTweetContent($)\n\n  return tweetContent\n}\n","import path from 'path'\nimport cheerio from 'cheerio'\nimport { URL } from 'url'\n\nconst TWEET_VIDEO_URL = 'https://video.twimg.com/tweet_video'\n\n// Could we use rehype directly and remove cheerio?\nfunction getTweetContent($, tweet, isMainTweet = true) {\n  if (!tweet.length) return\n\n  const meta: any = {}\n  const content: any = { meta }\n  const tweetContent = tweet.children('.js-tweet-text-container').children('p')\n  const actions = tweet\n    .children('.stream-item-footer')\n    .children('.ProfileTweet-actionCountList')\n    .children()\n  const hasCard =\n    tweet.children('.js-tweet-details-fixer').children('.card2').length > 0\n\n  let quotedTweet\n  let mediaHtml\n  let hasVideo = false\n\n  // Add the user avatar and date to the tweet only if it's the main tweet\n  if (isMainTweet) {\n    const avatar = tweet.find('.account-group').children('.avatar')\n    const time = tweet.find('a.tweet-timestamp').children('span')\n\n    meta.avatar = { bigger: avatar.attr('src') }\n    meta.createdAt = Number(time.attr('data-time-ms'))\n  }\n\n  tweetContent.children('img').each(function () {\n    const props = this.attribs\n\n    // Handle emojis inside the text\n    if (props.class && props.class.includes('Emoji--forText')) {\n      this.attribs = {\n        'data-type': 'emoji-for-text',\n        src: props.src,\n        alt: props.alt\n      }\n      return\n    }\n\n    console.error(\n      'An image with the following props is not being handled:',\n      props\n    )\n  })\n\n  tweetContent.children('a').each(function () {\n    const props = this.attribs\n    const el = $(this)\n\n    if (props['data-expanded-url']) {\n      const url = props['data-expanded-url']\n      const quotedTweetPath = tweet\n        .children('.QuoteTweet')\n        .find('.QuoteTweet-link')\n        .attr('href')\n\n      // Embedded Tweet\n      if (quotedTweetPath && url.endsWith(quotedTweetPath)) {\n        quotedTweet = { url }\n        el.remove()\n        return\n      }\n\n      // If Twitter is hiding the link, it's because it's adding a card with a preview\n      const isLinkPreview = props.class && props.class.includes('u-hidden')\n\n      if (isLinkPreview) {\n        // In the case of a preview we only add a line break between the link and the paragraph.\n        // TODO: Add the preview HTML and remove the link\n        el.before('<br>')\n      }\n\n      // Handle normal links\n      const text = { type: 'text', data: url }\n      // Replace the link with plain text and markdown will take care of it\n      el.replaceWith(text)\n\n      return\n    }\n\n    // Embedded media\n    if (props['data-pre-embedded'] === 'true') {\n      const adaptiveMedia = tweet\n        .children('.AdaptiveMediaOuterContainer')\n        .children('.AdaptiveMedia')\n      const isVideo = adaptiveMedia.hasClass('is-video')\n      const media = $('<div>')\n\n      // Videos and gifs\n      if (isVideo) {\n        const img = adaptiveMedia\n          .find('.PlayableMedia-player')\n          .css('background-image')\n        const url = new URL(img.slice(4, -1).replace(/['\"]/g, ''))\n        const fileName = path.basename(url.pathname)\n        const ext = path.extname(fileName)\n        const videoUrl = `${TWEET_VIDEO_URL}/${fileName.replace(ext, '.mp4')}`\n\n        // Gifs\n        if (url.pathname.startsWith('/tweet_video_thumb')) {\n          const video = $(\n            `<video poster=\"${url.href}\" controls playsinline autoplay muted loop>`\n          ).append(`<source src=\"${videoUrl}\" type=\"video/mp4\">`)\n          media.attr('data-type', 'gif-container').append(video)\n        } else {\n          // Custom videos require a call to the Twitter API to get the URL of the video\n          hasVideo = true\n          media.attr('data-type', 'video-container')\n        }\n      } else {\n        const images = adaptiveMedia.find('img')\n\n        images.each(function () {\n          const img = $(this)\n          const src = img.attr('src')\n          const alt = img.attr('alt')\n\n          this.attribs = { 'data-type': 'media-image', src }\n          if (alt) {\n            this.attribs.alt = alt\n          }\n          // Move the media img to a new container\n          media.append(img)\n        })\n        media.attr('data-type', `image-container ${images.length}`)\n      }\n\n      mediaHtml = $('<div>').append(media).html()\n\n      el.remove()\n      return\n    }\n\n    const asTwitterLink = (type) => {\n      this.attribs = {\n        'data-type': type,\n        href: props.href\n      }\n      // Replace custom tags inside the anchor with text\n      el.text(el.text())\n    }\n\n    // @mention\n    if (props['data-mentioned-user-id']) {\n      return asTwitterLink('mention')\n    }\n\n    // #hashtag\n    if (props['data-query-source'] === 'hashtag_click') {\n      return asTwitterLink('hashtag')\n    }\n\n    // $cashtag\n    if (props['data-query-source'] === 'cashtag_click') {\n      return asTwitterLink('cashtag')\n    }\n\n    console.error(\n      'An anchor with the following props is not being handled:',\n      props\n    )\n  })\n\n  actions.each(function () {\n    const el = $(this)\n    const className = this.attribs.class\n    const is = (name) => className.includes(`ProfileTweet-action--${name}`)\n    const count = Number(el.children('span').attr('data-tweet-stat-count'))\n\n    if (Number.isNaN(count)) return\n\n    if (is('reply')) {\n      meta.replies = count\n    } else if (is('retweet')) {\n      meta.retweets = count\n    } else if (is('favorite')) {\n      meta.likes = count\n    }\n  })\n\n  content.html = tweetContent.html()\n\n  if (quotedTweet) content.quotedTweet = quotedTweet\n  if (mediaHtml) content.mediaHtml = mediaHtml\n  if (hasVideo) content.hasVideo = true\n  // If a card is detected, it's a Poll\n  if (hasCard) content.hasPoll = true\n\n  return content\n}\n\nfunction addTweetMetadata(data, tweet) {\n  Object.assign(data.meta, {\n    id: tweet.attr('data-tweet-id'),\n    username: tweet.attr('data-screen-name'),\n    name: tweet.attr('data-name')\n  })\n  return data\n}\n\nexport function getVideo(html, { poster, url }) {\n  const $ = cheerio.load(html, {\n    decodeEntities: false,\n    xmlMode: false\n  })\n  const container = $('[data-type=video-container]')\n  const video = $(\n    `<video poster=\"${poster}\" controls preload=\"none\" playsinline>`\n  ).append(`<source src=\"${url}\" type=\"video/mp4\">`)\n\n  return $('<div>').append(container.append(video)).html()\n}\n\nexport function getTweetData(html, { thread = null } = {}) {\n  const $ = cheerio.load(html, {\n    decodeEntities: false,\n    xmlMode: false\n  })\n  const tweet = $('.permalink-tweet-container > .permalink-tweet')\n  const tweetContent = tweet.length && getTweetContent($, tweet, true)\n\n  if (!tweetContent) return null\n\n  tweetContent.meta.mainTweet = true\n\n  const selfThread = [addTweetMetadata(tweetContent, tweet)]\n\n  if (!thread) return selfThread\n\n  const replies = $('#stream-items-id')\n\n  replies\n    .children('.ThreadedConversation--selfThread')\n    .children('ol')\n    .children()\n    .each(function () {\n      const selfTweet = $(this).children('li').children('.tweet')\n      const selfTweetContent = getTweetContent(\n        $,\n        selfTweet.children('.content')\n      )\n\n      if (selfTweetContent) {\n        selfThread.push(addTweetMetadata(selfTweetContent, selfTweet))\n      }\n    })\n\n  return selfThread\n}\n","import unified from 'unified'\nimport markdown from 'remark-parse'\nimport remarkToRehype from 'remark-rehype'\nimport raw from 'rehype-raw'\nimport prism from '@mapbox/rehype-prism'\n\nconst handlers = {\n  // Add a className to inlineCode so we can differentiate between it and code fragments\n  inlineCode(_: any, node) {\n    return {\n      ...node,\n      type: 'element',\n      tagName: 'code',\n      properties: { className: 'inline' },\n      children: [\n        {\n          type: 'text',\n          value: node.value\n        }\n      ]\n    }\n  }\n}\n\nfunction toAst() {\n  this.Compiler = (tree) => tree\n}\n\n// Create the processor, the order of the plugins is important\nconst processor = unified()\n  .use(markdown)\n  .use(remarkToRehype, { handlers, allowDangerousHtml: true })\n  // Add custom HTML found in the tweet to the AST\n  .use(raw)\n  // Add syntax highlighting\n  .use(prism)\n  .use(toAst)\n\nexport default async function markdownToAst(md) {\n  try {\n    const file = await processor.process(md)\n    return file.result\n  } catch (error) {\n    // eslint-disable-next-line no-console\n    console.error(`Markdown to AST error: ${error}`)\n    throw error\n  }\n}\n","import { getVideo } from './tweet-html'\nimport {\n  fetchUserStatus,\n  getEmbeddedTweetHtml,\n  fetchTweetWithPoll\n} from './api'\nimport { fetchTweetAst } from '../fetchTweetAst'\nimport markdownToAst from '../markdown/markdownToAst'\n\nfunction getVideoData(userStatus) {\n  const video = userStatus.extended_entities.media[0]\n  const poster = video.media_url_https\n  // Find the first mp4 video in the array, if the results are always properly sorted, then\n  // it should always be the mp4 video with the lowest bitrate\n  const mp4Video = video.video_info.variants.find(\n    (v) => v.content_type === 'video/mp4'\n  )\n\n  if (!mp4Video) return\n\n  return { poster, ...mp4Video }\n}\n\nfunction getPollData(tweet) {\n  const polls = tweet.includes && tweet.includes.polls\n  return polls && polls[0]\n}\n\nasync function getMediaHtml(tweet) {\n  let media = tweet.mediaHtml\n\n  if (tweet.hasVideo) {\n    const userStatus = await fetchUserStatus(tweet.meta.id)\n    const video = userStatus && getVideoData(userStatus)\n\n    media = video ? getVideo(media, video) : null\n  }\n\n  return media\n}\n\nasync function getQuotedTweetHtml({ quotedTweet }, context) {\n  if (!quotedTweet) return\n\n  if (process.env.NEXT_PUBLIC_TWITTER_LOAD_WIDGETS === 'true') {\n    const data = await getEmbeddedTweetHtml(quotedTweet.url)\n    return data?.html\n  } else {\n    const ast = await fetchTweetAst(quotedTweet.id)\n    // The AST of embedded tweets is always sent as data\n    return ast && `<blockquote data-id=\"${context.add({ ast })}\"></blockquote>`\n  }\n}\n\nasync function getPollHtml(tweet, context) {\n  if (!tweet.hasPoll) return null\n\n  const tweetData = await fetchTweetWithPoll(tweet.meta.id)\n  const poll = tweetData && getPollData(tweetData)\n\n  if (poll) {\n    const meta = {\n      type: 'poll-container',\n      endsAt: poll.end_datetime,\n      duration: poll.duration_minutes,\n      status: poll.voting_status,\n      options: poll.options\n    }\n\n    return `<div data-id=\"${context.add(meta)}\"></div>`\n  }\n\n  return null\n}\n\nexport default async function getTweetHtml(tweet, context) {\n  const meta = { ...tweet.meta, type: 'tweet' }\n  const md: any = await markdownToAst(tweet.html)\n\n  const html = [\n    // md.children is the markdown content, which is later added as children to the container\n    `<div data-id=\"${context.add(meta, md.children)}\">`,\n    (await getMediaHtml(tweet)) || '',\n    (await getQuotedTweetHtml(tweet, context)) || '',\n    (await getPollHtml(tweet, context)) || '',\n    `</div>`\n  ].join('')\n\n  return html\n}\n","/**\n * @typedef {import('unist').Node} Node\n * @typedef {import('unist').Parent} Parent\n *\n * @typedef {string} Type\n * @typedef {Object<string, unknown>} Props\n *\n * @typedef {null|undefined|Type|Props|TestFunctionAnything|Array.<Type|Props|TestFunctionAnything>} Test\n */\n\n/**\n * Check if a node passes a test\n *\n * @callback TestFunctionAnything\n * @param {Node} node\n * @param {number} [index]\n * @param {Parent} [parent]\n * @returns {boolean|void}\n */\n\n/**\n * Check if a node passes a certain node test\n *\n * @template {Node} X\n * @callback TestFunctionPredicate\n * @param {Node} node\n * @param {number} [index]\n * @param {Parent} [parent]\n * @returns {node is X}\n */\n\n/**\n * @callback AssertAnything\n * @param {unknown} [node]\n * @param {number} [index]\n * @param {Parent} [parent]\n * @returns {boolean}\n */\n\n/**\n * Check if a node passes a certain node test\n *\n * @template {Node} Y\n * @callback AssertPredicate\n * @param {unknown} [node]\n * @param {number} [index]\n * @param {Parent} [parent]\n * @returns {node is Y}\n */\n\nexport var is =\n  /**\n   * Check if a node passes a test.\n   * When a `parent` node is known the `index` of node should also be given.\n   *\n   * @type {(\n   *   (<T extends Node>(node: unknown, test: T['type']|Partial<T>|TestFunctionPredicate<T>|Array.<T['type']|Partial<T>|TestFunctionPredicate<T>>, index?: number, parent?: Parent, context?: unknown) => node is T) &\n   *   ((node?: unknown, test?: Test, index?: number, parent?: Parent, context?: unknown) => boolean)\n   * )}\n   */\n  (\n    /**\n     * Check if a node passes a test.\n     * When a `parent` node is known the `index` of node should also be given.\n     *\n     * @param {unknown} [node] Node to check\n     * @param {Test} [test]\n     * When nullish, checks if `node` is a `Node`.\n     * When `string`, works like passing `function (node) {return node.type === test}`.\n     * When `function` checks if function passed the node is true.\n     * When `object`, checks that all keys in test are in node, and that they have (strictly) equal values.\n     * When `array`, checks any one of the subtests pass.\n     * @param {number} [index] Position of `node` in `parent`\n     * @param {Parent} [parent] Parent of `node`\n     * @param {unknown} [context] Context object to invoke `test` with\n     * @returns {boolean} Whether test passed and `node` is a `Node` (object with `type` set to non-empty `string`).\n     */\n    // eslint-disable-next-line max-params\n    function is(node, test, index, parent, context) {\n      var check = convert(test)\n\n      if (\n        index !== undefined &&\n        index !== null &&\n        (typeof index !== 'number' ||\n          index < 0 ||\n          index === Number.POSITIVE_INFINITY)\n      ) {\n        throw new Error('Expected positive finite index')\n      }\n\n      if (\n        parent !== undefined &&\n        parent !== null &&\n        (!is(parent) || !parent.children)\n      ) {\n        throw new Error('Expected parent node')\n      }\n\n      if (\n        (parent === undefined || parent === null) !==\n        (index === undefined || index === null)\n      ) {\n        throw new Error('Expected both parent and index')\n      }\n\n      // @ts-ignore Looks like a node.\n      return node && node.type && typeof node.type === 'string'\n        ? Boolean(check.call(context, node, index, parent))\n        : false\n    }\n  )\n\nexport var convert =\n  /**\n   * @type {(\n   *   (<T extends Node>(test: T['type']|Partial<T>|TestFunctionPredicate<T>) => AssertPredicate<T>) &\n   *   ((test?: Test) => AssertAnything)\n   * )}\n   */\n  (\n    /**\n     * Generate an assertion from a check.\n     * @param {Test} [test]\n     * When nullish, checks if `node` is a `Node`.\n     * When `string`, works like passing `function (node) {return node.type === test}`.\n     * When `function` checks if function passed the node is true.\n     * When `object`, checks that all keys in test are in node, and that they have (strictly) equal values.\n     * When `array`, checks any one of the subtests pass.\n     * @returns {AssertAnything}\n     */\n    function (test) {\n      if (test === undefined || test === null) {\n        return ok\n      }\n\n      if (typeof test === 'string') {\n        return typeFactory(test)\n      }\n\n      if (typeof test === 'object') {\n        // @ts-ignore looks like a list of tests / partial test object.\n        return 'length' in test ? anyFactory(test) : propsFactory(test)\n      }\n\n      if (typeof test === 'function') {\n        return castFactory(test)\n      }\n\n      throw new Error('Expected function, string, or object as test')\n    }\n  )\n/**\n * @param {Array.<Type|Props|TestFunctionAnything>} tests\n * @returns {AssertAnything}\n */\nfunction anyFactory(tests) {\n  /** @type {Array.<AssertAnything>} */\n  var checks = []\n  var index = -1\n\n  while (++index < tests.length) {\n    checks[index] = convert(tests[index])\n  }\n\n  return castFactory(any)\n\n  /**\n   * @this {unknown}\n   * @param {unknown[]} parameters\n   * @returns {boolean}\n   */\n  function any(...parameters) {\n    var index = -1\n\n    while (++index < checks.length) {\n      if (checks[index].call(this, ...parameters)) return true\n    }\n  }\n}\n\n/**\n * Utility to assert each property in `test` is represented in `node`, and each\n * values are strictly equal.\n *\n * @param {Props} check\n * @returns {AssertAnything}\n */\nfunction propsFactory(check) {\n  return castFactory(all)\n\n  /**\n   * @param {Node} node\n   * @returns {boolean}\n   */\n  function all(node) {\n    /** @type {string} */\n    var key\n\n    for (key in check) {\n      if (node[key] !== check[key]) return\n    }\n\n    return true\n  }\n}\n\n/**\n * Utility to convert a string into a function which checks a given node’s type\n * for said string.\n *\n * @param {Type} check\n * @returns {AssertAnything}\n */\nfunction typeFactory(check) {\n  return castFactory(type)\n\n  /**\n   * @param {Node} node\n   */\n  function type(node) {\n    return node && node.type === check\n  }\n}\n\n/**\n * Utility to convert a string into a function which checks a given node’s type\n * for said string.\n * @param {TestFunctionAnything} check\n * @returns {AssertAnything}\n */\nfunction castFactory(check) {\n  return assertion\n\n  /**\n   * @this {unknown}\n   * @param {Array.<unknown>} parameters\n   * @returns {boolean}\n   */\n  function assertion(...parameters) {\n    return Boolean(check.call(this, ...parameters))\n  }\n}\n\n// Utility to return true.\nfunction ok() {\n  return true\n}\n","/**\n * @param {string} d\n * @returns {string}\n */\nexport function color(d) {\n  return '\\u001B[33m' + d + '\\u001B[39m'\n}\n","/**\n * @typedef {import('unist').Node} Node\n * @typedef {import('unist').Parent} Parent\n * @typedef {import('unist-util-is').Test} Test\n */\n\n/**\n * @typedef {CONTINUE|SKIP|EXIT} Action Union of the action types\n * @typedef {number} Index Move to the sibling at index next (after node itself is completely traversed). Useful if mutating the tree, such as removing the node the visitor is currently on, or any of its previous siblings (or next siblings, in case of reverse) Results less than 0 or greater than or equal to children.length stop traversing the parent\n * @typedef {[(Action|null|undefined|void)?, (Index|null|undefined)?]} ActionTuple List with one or two values, the first an action, the second an index.\n * @typedef {null|undefined|Action|Index|ActionTuple|void} VisitorResult Any value that can be returned from a visitor\n */\n\n/**\n * Invoked when a node (matching test, if given) is found.\n * Visitors are free to transform node.\n * They can also transform the parent of node (the last of ancestors).\n * Replacing node itself, if `SKIP` is not returned, still causes its descendants to be visited.\n * If adding or removing previous siblings (or next siblings, in case of reverse) of node,\n * visitor should return a new index (number) to specify the sibling to traverse after node is traversed.\n * Adding or removing next siblings of node (or previous siblings, in case of reverse)\n * is handled as expected without needing to return a new index.\n * Removing the children property of an ancestor still results in them being traversed.\n *\n * @template {Node} V\n * @callback Visitor\n * @param {V} node Found node\n * @param {Array.<Parent>} ancestors Ancestors of node\n * @returns {VisitorResult}\n */\n\nimport {convert} from 'unist-util-is'\nimport {color} from './color.js'\n\n/**\n * Continue traversing as normal\n */\nexport const CONTINUE = true\n/**\n * Do not traverse this node’s children\n */\nexport const SKIP = 'skip'\n/**\n * Stop traversing immediately\n */\nexport const EXIT = false\n\nexport const visitParents =\n  /**\n   * @type {(\n   *   (<T extends Node>(tree: Node, test: T['type']|Partial<T>|import('unist-util-is').TestFunctionPredicate<T>|Array.<T['type']|Partial<T>|import('unist-util-is').TestFunctionPredicate<T>>, visitor: Visitor<T>, reverse?: boolean) => void) &\n   *   ((tree: Node, test: Test, visitor: Visitor<Node>, reverse?: boolean) => void) &\n   *   ((tree: Node, visitor: Visitor<Node>, reverse?: boolean) => void)\n   * )}\n   */\n  (\n    /**\n     * Visit children of tree which pass a test\n     *\n     * @param {Node} tree Abstract syntax tree to walk\n     * @param {Test} test test Test node\n     * @param {Visitor<Node>} visitor Function to run for each node\n     * @param {boolean} [reverse] Fisit the tree in reverse, defaults to false\n     */\n    function (tree, test, visitor, reverse) {\n      if (typeof test === 'function' && typeof visitor !== 'function') {\n        reverse = visitor\n        // @ts-ignore no visitor given, so `visitor` is test.\n        visitor = test\n        test = null\n      }\n\n      var is = convert(test)\n      var step = reverse ? -1 : 1\n\n      factory(tree, null, [])()\n\n      /**\n       * @param {Node} node\n       * @param {number?} index\n       * @param {Array.<Parent>} parents\n       */\n      function factory(node, index, parents) {\n        /** @type {Object.<string, unknown>} */\n        var value = typeof node === 'object' && node !== null ? node : {}\n        /** @type {string} */\n        var name\n\n        if (typeof value.type === 'string') {\n          name =\n            typeof value.tagName === 'string'\n              ? value.tagName\n              : typeof value.name === 'string'\n              ? value.name\n              : undefined\n\n          Object.defineProperty(visit, 'name', {\n            value:\n              'node (' +\n              color(value.type + (name ? '<' + name + '>' : '')) +\n              ')'\n          })\n        }\n\n        return visit\n\n        function visit() {\n          /** @type {ActionTuple} */\n          var result = []\n          /** @type {ActionTuple} */\n          var subresult\n          /** @type {number} */\n          var offset\n          /** @type {Array.<Parent>} */\n          var grandparents\n\n          if (!test || is(node, index, parents[parents.length - 1] || null)) {\n            result = toResult(visitor(node, parents))\n\n            if (result[0] === EXIT) {\n              return result\n            }\n          }\n\n          if (node.children && result[0] !== SKIP) {\n            // @ts-ignore looks like a parent.\n            offset = (reverse ? node.children.length : -1) + step\n            // @ts-ignore looks like a parent.\n            grandparents = parents.concat(node)\n\n            // @ts-ignore looks like a parent.\n            while (offset > -1 && offset < node.children.length) {\n              subresult = factory(node.children[offset], offset, grandparents)()\n\n              if (subresult[0] === EXIT) {\n                return subresult\n              }\n\n              offset =\n                typeof subresult[1] === 'number' ? subresult[1] : offset + step\n            }\n          }\n\n          return result\n        }\n      }\n    }\n  )\n\n/**\n * @param {VisitorResult} value\n * @returns {ActionTuple}\n */\nfunction toResult(value) {\n  if (Array.isArray(value)) {\n    return value\n  }\n\n  if (typeof value === 'number') {\n    return [CONTINUE, value]\n  }\n\n  return [value]\n}\n","/**\n * @typedef {import('unist').Node} Node\n * @typedef {import('unist').Parent} Parent\n * @typedef {import('unist-util-is').Test} Test\n * @typedef {import('unist-util-visit-parents').VisitorResult} VisitorResult\n */\n\n/**\n * Invoked when a node (matching test, if given) is found.\n * Visitors are free to transform node.\n * They can also transform the parent of node (the last of ancestors).\n * Replacing node itself, if `SKIP` is not returned, still causes its descendants to be visited.\n * If adding or removing previous siblings (or next siblings, in case of reverse) of node,\n * visitor should return a new index (number) to specify the sibling to traverse after node is traversed.\n * Adding or removing next siblings of node (or previous siblings, in case of reverse)\n * is handled as expected without needing to return a new index.\n * Removing the children property of an ancestor still results in them being traversed.\n *\n * @template {Node} V\n * @callback Visitor\n * @param {V} node Found node\n * @param {number|null} index Position of `node` in `parent`\n * @param {Parent|null} parent Parent of `node`\n * @returns {VisitorResult}\n */\n\nimport {visitParents, CONTINUE, SKIP, EXIT} from 'unist-util-visit-parents'\n\nexport {CONTINUE, SKIP, EXIT}\n\nexport const visit =\n  /**\n   * @type {(\n   *   (<T extends Node>(tree: Node, test: T['type']|Partial<T>|import('unist-util-is').TestFunctionPredicate<T>|Array.<T['type']|Partial<T>|import('unist-util-is').TestFunctionPredicate<T>>, visitor: Visitor<T>, reverse?: boolean) => void) &\n   *   ((tree: Node, test: Test, visitor: Visitor<Node>, reverse?: boolean) => void) &\n   *   ((tree: Node, visitor: Visitor<Node>, reverse?: boolean) => void)\n   * )}\n   */\n  (\n    /**\n     * Visit children of tree which pass a test\n     *\n     * @param {Node} tree Abstract syntax tree to walk\n     * @param {Test} test test Test node\n     * @param {Visitor<Node>} visitor Function to run for each node\n     * @param {boolean} [reverse] Fisit the tree in reverse, defaults to false\n     */\n    function (tree, test, visitor, reverse) {\n      if (typeof test === 'function' && typeof visitor !== 'function') {\n        reverse = visitor\n        visitor = test\n        test = null\n      }\n\n      visitParents(tree, test, overload, reverse)\n\n      /**\n       * @param {Node} node\n       * @param {Array.<Parent>} parents\n       */\n      function overload(node, parents) {\n        var parent = parents[parents.length - 1]\n        return visitor(\n          node,\n          parent ? parent.children.indexOf(node) : null,\n          parent\n        )\n      }\n    }\n  )\n","/**\n * @typedef Options\n * @property {boolean} [includeImageAlt=true]\n */\n\n/**\n * Get the text content of a node.\n * Prefer the node’s plain-text fields, otherwise serialize its children,\n * and if the given value is an array, serialize the nodes in it.\n *\n * @param {unknown} node\n * @param {Options} [options]\n * @returns {string}\n */\nexport function toString(node, options) {\n  var {includeImageAlt = true} = options || {}\n  return one(node, includeImageAlt)\n}\n\n/**\n * @param {unknown} node\n * @param {boolean} includeImageAlt\n * @returns {string}\n */\nfunction one(node, includeImageAlt) {\n  return (\n    (node &&\n      typeof node === 'object' &&\n      // @ts-ignore looks like a literal.\n      (node.value ||\n        // @ts-ignore looks like an image.\n        (includeImageAlt ? node.alt : '') ||\n        // @ts-ignore looks like a parent.\n        ('children' in node && all(node.children, includeImageAlt)) ||\n        (Array.isArray(node) && all(node, includeImageAlt)))) ||\n    ''\n  )\n}\n\n/**\n * @param {Array.<unknown>} values\n * @param {boolean} includeImageAlt\n * @returns {string}\n */\nfunction all(values, includeImageAlt) {\n  /** @type {Array.<string>} */\n  var result = []\n  var index = -1\n\n  while (++index < values.length) {\n    result[index] = one(values[index], includeImageAlt)\n  }\n\n  return result.join('')\n}\n","import { resolve } from 'url'\nimport { visit } from 'unist-util-visit'\nimport { toString } from 'mdast-util-to-string'\n\nconst TWITTER_URL = 'https://twitter.com'\nconst ABSOLUTE_URL = /^https?:\\/\\/|^\\/\\//i\nconst HEADINGS = ['h1', 'h2', 'h3', 'h4', 'h5', 'h6']\n\nfunction visitAnchor(node) {\n  if (!node.properties) return\n\n  const { href } = node.properties\n\n  if (!href) return\n\n  const isAbsoluteUrl = ABSOLUTE_URL.test(href)\n\n  if (!isAbsoluteUrl) {\n    node.properties.href = resolve(TWITTER_URL, href)\n  }\n}\n\nexport default function rehypeTweet(context) {\n  // Nodes may have custom data required by the UI\n  function visitData(node) {\n    const ctx = context.get(node.properties.dataId)\n\n    if (ctx?.data) node.data = ctx.data\n\n    // Add markdown content to the tweet container\n    if (ctx?.nodes) {\n      node.children.unshift(...ctx.nodes)\n    }\n\n    delete node.properties.dataId\n  }\n\n  function visitHeading(node) {\n    const text = toString(node)\n\n    if (!text) return\n\n    const id = context.slugger.slug(text)\n\n    node.data = { id }\n  }\n\n  return function transformer(tree) {\n    visit(tree, (node: any) => node.properties?.dataId, visitData)\n    visit(tree, (node: any) => node.tagName === 'a', visitAnchor)\n    visit(tree, (node: any) => HEADINGS.includes(node.tagName), visitHeading)\n  }\n}\n","function minifyAst(ast) {\n  if (Array.isArray(ast)) {\n    return ast.reduce((nodes, node) => {\n      const n = minifyAst(node)\n      // Empty new lines aren't required\n      const isNoise = n === '\\n' && nodes[nodes.length - 1]?.tag !== 'span'\n\n      if (!isNoise) nodes.push(n)\n\n      return nodes\n    }, [])\n  }\n  // Handle the root ast\n  if (!ast.tagName && ast.children) {\n    return minifyAst(ast.children)\n  }\n  if (ast.type === 'text') {\n    return ast.value\n  }\n  if (ast.type === 'element') {\n    const node: any = { tag: ast.tagName }\n    const children = ast.children?.length ? minifyAst(ast.children) : []\n\n    if (ast.properties && Object.keys(ast.properties).length) {\n      node.props = ast.properties\n    }\n    if (ast.data) {\n      node.data = ast.data\n    }\n    if (children.length) {\n      node.nodes = children\n    }\n\n    return node\n  }\n\n  throw new Error(\n    `Unable to handle the following AST: ${JSON.stringify(ast, null, 2)}`\n  )\n}\n\nfunction rehypeMinify() {\n  this.Compiler = (tree) => minifyAst(tree)\n}\n\nexport default rehypeMinify\n","/** @type {import('./index.js').Schema} */\nexport const defaultSchema = {\n  strip: ['script'],\n  clobberPrefix: 'user-content-',\n  clobber: ['name', 'id'],\n  ancestors: {\n    tbody: ['table'],\n    tfoot: ['table'],\n    thead: ['table'],\n    td: ['table'],\n    th: ['table'],\n    tr: ['table']\n  },\n  protocols: {\n    href: ['http', 'https', 'mailto', 'xmpp', 'irc', 'ircs'],\n    cite: ['http', 'https'],\n    src: ['http', 'https'],\n    longDesc: ['http', 'https']\n  },\n  tagNames: [\n    'h1',\n    'h2',\n    'h3',\n    'h4',\n    'h5',\n    'h6',\n    'br',\n    'b',\n    'i',\n    'strong',\n    'em',\n    'a',\n    'pre',\n    'code',\n    'img',\n    'tt',\n    'div',\n    'ins',\n    'del',\n    'sup',\n    'sub',\n    'p',\n    'ol',\n    'ul',\n    'table',\n    'thead',\n    'tbody',\n    'tfoot',\n    'blockquote',\n    'dl',\n    'dt',\n    'dd',\n    'kbd',\n    'q',\n    'samp',\n    'var',\n    'hr',\n    'ruby',\n    'rt',\n    'rp',\n    'li',\n    'tr',\n    'td',\n    'th',\n    's',\n    'strike',\n    'summary',\n    'details',\n    'caption',\n    'figure',\n    'figcaption',\n    'abbr',\n    'bdo',\n    'cite',\n    'dfn',\n    'mark',\n    'small',\n    'span',\n    'time',\n    'wbr',\n    'input'\n  ],\n  attributes: {\n    a: ['href'],\n    img: ['src', 'longDesc'],\n    input: [\n      ['type', 'checkbox'],\n      ['disabled', true]\n    ],\n    li: [['className', 'task-list-item']],\n    div: ['itemScope', 'itemType'],\n    blockquote: ['cite'],\n    del: ['cite'],\n    ins: ['cite'],\n    q: ['cite'],\n    '*': [\n      'abbr',\n      'accept',\n      'acceptCharset',\n      'accessKey',\n      'action',\n      'align',\n      'alt',\n      'ariaDescribedBy',\n      'ariaHidden',\n      'ariaLabel',\n      'ariaLabelledBy',\n      'axis',\n      'border',\n      'cellPadding',\n      'cellSpacing',\n      'char',\n      'charOff',\n      'charSet',\n      'checked',\n      'clear',\n      'cols',\n      'colSpan',\n      'color',\n      'compact',\n      'coords',\n      'dateTime',\n      'dir',\n      'disabled',\n      'encType',\n      'htmlFor',\n      'frame',\n      'headers',\n      'height',\n      'hrefLang',\n      'hSpace',\n      'isMap',\n      'id',\n      'label',\n      'lang',\n      'maxLength',\n      'media',\n      'method',\n      'multiple',\n      'name',\n      'noHref',\n      'noShade',\n      'noWrap',\n      'open',\n      'prompt',\n      'readOnly',\n      'rel',\n      'rev',\n      'rows',\n      'rowSpan',\n      'rules',\n      'scope',\n      'selected',\n      'shape',\n      'size',\n      'span',\n      'start',\n      'summary',\n      'tabIndex',\n      'target',\n      'title',\n      'type',\n      'useMap',\n      'vAlign',\n      'value',\n      'vSpace',\n      'width',\n      'itemProp'\n    ]\n  },\n  required: {\n    input: {\n      type: 'checkbox',\n      disabled: true\n    }\n  }\n}\n","import { defaultSchema, Schema } from 'hast-util-sanitize'\n\nconst githubSchema: Schema = defaultSchema\n\ngithubSchema.tagNames.push('video', 'source')\n\n// Allow className for all elements\ngithubSchema.attributes['*'].push('className')\n\n// Allow specific attributes that are required for the page to render properly\ngithubSchema.attributes.div = ['dataType', 'dataId']\ngithubSchema.attributes.blockquote = ['dataId']\ngithubSchema.attributes.img = ['dataType', 'src', 'height', 'width']\ngithubSchema.attributes.video = [\n  'poster',\n  'controls',\n  'preload',\n  'playsInline',\n  'autoPlay',\n  'muted',\n  'loop'\n]\ngithubSchema.attributes.source = ['src']\n\nexport default githubSchema\n","import unified from 'unified'\nimport parse from 'rehype-parse'\nimport sanitize from 'rehype-sanitize'\nimport tweet from './rehype-tweet'\nimport minify from './rehype-minify'\nimport schema from './schema'\n\n// Create the processor, the order of the plugins is important\nconst getProcessor = unified()\n  .use(parse)\n  // Sanitize the HTML\n  .use<[typeof schema]>(sanitize, schema)\n  .use(minify)\n  .freeze()\n\nexport default async function htmlToAst(html, context) {\n  try {\n    const processor = getProcessor().use(tweet, context)\n    const file = await processor.process(html)\n    return file.result\n  } catch (error) {\n    // eslint-disable-next-line no-console\n    console.error(`HTML to AST error: ${error}`)\n    throw error\n  }\n}\n","import GithubSlugger from 'github-slugger'\nimport { fetchTweetHtml } from './twitter/api'\nimport { getTweetData } from './twitter/embed/tweet-html'\nimport getTweetHtml from './twitter/getTweetHtml'\nimport htmlToAst from './markdown/htmlToAst'\n\nclass Context {\n  slugger = new GithubSlugger()\n  map = []\n\n  get(id) {\n    return this.map[Number(id)]\n  }\n\n  add(data, nodes) {\n    return this.map.push({ data, nodes }) - 1\n  }\n}\n\nexport async function fetchTweetAst(tweetId: string): Promise<any> {\n  const tweetHtml = await fetchTweetHtml(tweetId)\n  const tweet = tweetHtml && getTweetData(tweetHtml)\n\n  if (!tweet) return null\n\n  const context = new Context()\n  const html = await getTweetHtml(tweet, context)\n  const ast = await htmlToAst(html, context)\n\n  return ast\n}\n"],"names":["vercelFetch","API_URL","SYNDICATION_URL","twitterLabsEnabled","expansions","process","env","TWITTER_LABS_ENABLED","exp","TWITTER_LABS_EXPANSIONS","includes","fetchTweetsHtml","ids","res","fetch","ok","json","status","Error","fetchTweetHtml","id","html","fetchUserStatus","tweetId","TWITTER_ACCESS_TOKEN","headers","authorization","console","log","get","fetchTweetWithPoll","getEmbeddedTweetHtml","url","getTweetContent","$","container","length","meta","content","subject","find","header","children","avatar","author","name","screenName","tweet","tweetContent","card","tweetInfo","fullTimestamp","heartCount","callToAction","profileText","conversationText","quotedTweet","mediaHtml","attr","normal","text","username","substring","createdAt","Date","getTime","ctaType","ctaCount","match","contents","each","el","type","trim","next","after","test","props","attribs","scribe","tweetCard","media","photo","photoGrid","photos","images","img","alt","format","height","width","src","append","class","error","asTwitterLink","href","data","replaceWith","getTweetData","cheerio","load","decodeEntities","xmlMode","getVideo","poster","video","handlers","inlineCode","_","node","tagName","properties","className","value","toAst","Compiler","tree","processor","unified","use","markdown","remarkToRehype","allowDangerousHtml","raw","prism","markdownToAst","md","file","result","getVideoData","userStatus","extended_entities","media_url_https","mp4Video","video_info","variants","v","content_type","getPollData","polls","getMediaHtml","hasVideo","getQuotedTweetHtml","context","NEXT_PUBLIC_TWITTER_LOAD_WIDGETS","ast","fetchTweetAst","add","getPollHtml","hasPoll","tweetData","poll","endsAt","end_datetime","duration","duration_minutes","voting_status","options","getTweetHtml","join","toString","includeImageAlt","one","all","Array","isArray","values","index","TWITTER_URL","ABSOLUTE_URL","HEADINGS","visitAnchor","isAbsoluteUrl","resolve","rehypeTweet","visitData","ctx","dataId","nodes","unshift","visitHeading","slugger","slug","transformer","visit","minifyAst","reduce","n","isNoise","tag","push","Object","keys","JSON","stringify","rehypeMinify","defaultSchema","strip","clobberPrefix","clobber","ancestors","tbody","tfoot","thead","td","th","tr","protocols","cite","longDesc","tagNames","attributes","a","input","li","div","blockquote","del","ins","q","required","disabled","githubSchema","source","getProcessor","parse","sanitize","schema","minify","freeze","htmlToAst","Context","GithubSlugger","map","Number","tweetHtml"],"mappings":"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"}